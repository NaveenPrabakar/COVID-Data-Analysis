---
output: github_document
---

# Introduction

Understanding hospital capacity is essential for evaluating how health systems respond to sustained pressure from infectious diseases such as COVID-19 and seasonal influenza. During periods of high transmission, hospitals face simultaneous stressors: shortages of ICU beds, limited staffing, constrained supply chains, and wide variation in patient loads across states. These factors influence not only patient outcomes but also public-health decision-making, emergency planning, and resource allocation.

In this report, We analyze U.S. hospital capacity and supply-chain readiness using detailed, hospital-level public data from the U.S. Department of Health and Human Services (HHS). Our goals are:

Describe the structure and contents of the dataset.

Quantify variation in COVID hospitalizations and ICU usage across states.

Investigate supply chain stability, including N95, PPE, ventilator supplies, and other critical resources.

Evaluate staffing shortages, a key limiting factor for safe hospital operation.

Critically examine surprising results using secondary methods and sensitivity checks.

Highlight patterns and insights that inform future research on hospital resilience.

Each section is organized around clear questions, with results supported by carefully curated visualizations and tables.

# Question

How consistently were U.S. hospitals able to obtain critical supplies such as N95 masks, PPE, and ventilators during periods of high patient demand?

# About the Data

This dataset contains hospital reporting completeness information collected weekly by the U.S. Department of Health and Human Services (HHS). All hospitals licensed to provide 24-hour care in the United States are required to submit operational and capacity data that support the federal response to COVID-19. The reporting period covers Friday through Thursday, and each row represents a single hospital’s submission for that week.

This information is essential for monitoring national hospital capacity, supply readiness, and the overall quality of data used in federal decision-making. Publishing these reports increases transparency and helps ensure hospitals are consistently providing the critical information needed for situational awareness and emergency planning.


```{r, message=FALSE, warning=FALSE}
#Install Dependencies
library(tidyverse)
```

# Intial Exploration of the Data

```{r, message=FALSE, warning=FALSE}
#Load the DataSet
hospital <- read_csv("Data/Hospitcal_Coverage.csv")
```

```{r}
#Inspect columns
dim(hospital)
str(hospital)
```

This dataset contains weekly reports from hospitals across the U.S. showing their capacity, resources, and equipment availability during a given reporting period.
Each row represents one hospital’s report for one week.

1. Hospital Identification

These columns tell you which hospital the row refers to. State – U.S. state the hospital is in. Facility Name – Name of the hospital. Street Address, City, Zip Code, County – Location information. Fips Code – Geographic code used for counties

2. Reporting Info

These describe the timing and quality of the reporting. Week Ending – The date that week’s data ends. Days at 100% – Number of days the hospital reported being at full capacity. Percentage of Required Fields Reported – How complete their report was. Reporting Source / Provider Subtype – Who submitted it and what type of facility it is.

3. Bed Capacity

These fields describe how many beds the hospital has and how many are being used. Common examples from your dataset include: inpatient_beds – Total hospital beds. inpatient_beds_used – Beds currently occupied. icu_beds – Total ICU beds. icu_beds_used – ICU beds currently occupied. adult_icu_bed_utilization – Percent of ICU beds in use. staffed_adult_icu_beds – ICU beds that have staff available. These numbers tell you how strained the hospital is.

4. COVID-Related Metrics

These show the level of COVID burden on the hospital. total_adult_patients_hospitalized_confirmed_covid. inpatient_beds_used_covid. icu_patients_confirmed_covid. These numbers capture COVID’s impact on hospital resources.

5. Equipment Availability

These columns show how many days the hospital has supplies for: n95_respirators_days_available, surgical_masks_days_available, ventilator_supplies_days_available, eye_protection_days_available, PAPR_days_available, single_use_gowns_days_available, ventilator_medications_days_available. These indicate how close a hospital is to running out of critical PPE or equipment.

6. Staffing & Operations

Some hospitals also report: number_of_travel_nurses_requested, staff_shortage_today, emergency_department_status. These describe operational strain.

# Data Cleaning

```{r}
#Convert ZIP and Fips to character
hospital <- hospital |>
  mutate(
    `Zip Code` = as.character(`Zip Code`),
    `Fips Code` = as.character(`Fips Code`)
  )
```

```{r}
#Replace empty strings with NA
hospital <- hospital |>
  mutate(
    across(where(is.character), ~ na_if(.x, ""))
  )
```

```{r}
# Convert Week Ending to Date
hospital$`Week Ending` <- as.Date(hospital$`Week Ending`)

# Convert CCN to character (hospital ID)
hospital$CCN <- as.character(hospital$CCN)

# Convert Certified Bed Count to numeric
hospital$`Certified Bed Count` <- as.numeric(hospital$`Certified Bed Count`)

# Convert Days at 100% to numeric
hospital$`Days at 100%` <- as.numeric(hospital$`Days at 100%`)

# Convert Percentage of Required Fields Reported to numeric
hospital$`Percentage of Required Fields Reported` <- as.numeric(hospital$`Percentage of Required Fields Reported`)

# Convert the big block of obvious numeric columns
numeric_cols <- c(
  "inpatient_beds", "all_adult_hospital_inpatient_beds",
  "all_pediatric_inpatient_beds", "inpatient_beds_used",
  "all_adult_hospital_inpatient_bed_occupied",
  "all_pediatric_inpatient_bed_occupied", "total_icu_beds",
  "total_staffed_adult_icu_beds", "total_staffed_pediatric_icu_beds",
  "icu_beds_used", "staffed_adult_icu_bed_occupancy",
  "staffed_pediatric_icu_bed_occupancy",
  "total_adult_patients_hospitalized_confirmed_covid",
  "total_pediatric_patients_hospitalized_confirmed_covid",
  "staffed_icu_adult_patients_confirmed_covid",
  "staffed_icu_pediatric_patients_confirmed_covid",
  "previous_day_admission_adult_covid_confirmed",
  "previous_day_admission_adult_covid_confirmed_all",
  "previous_day_admission_pediatric_covid_confirmed",
  "previous_day_admission_peds_covid_confirmed_all",
  "total_patients_hospitalized_confirmed_influenza",
  "previous_day_admission_influenza_confirmed",
  "icu_patients_confirmed_influenza",
  "n95_respirators_days_available",
  "on_hand_supply_of_surgical_masks_in_days",
  "on_hand_supply_of_eye_protection_in_days",
  "on_hand_supply_of_single_use_surgical_gowns_in_days",
  "on_hand_supply_of_gloves_in_days"
)

hospital[numeric_cols] <- lapply(hospital[numeric_cols], as.numeric)

# Convert logical (Yes/No) supply/ability columns
logical_cols <- c(
  "able_to_maintain_n95_masks",
  "able_to_maintain_surgical_masks",
  "able_to_maintain_eye_protection",
  "able_to_maintain_single_use_gowns",
  "able_to_maintain_gloves"
)

hospital[logical_cols] <- lapply(hospital[logical_cols], as.logical)

hospital <- hospital |> mutate(`Week Ending` = as.Date(`Week Ending`))

```


```{r}
#Save Cleaned Dataset
write_csv(hospital, "Data/cleaned_Hospital_Coverage.csv")

```


The dataset was cleaned to ensure accuracy, consistency, and proper formatting before analysis. ZIP Codes, FIPS Codes, and hospital identifiers were converted to character fields to preserve leading zeros and avoid numeric distortion. Empty strings across all character variables were replaced with NA to correctly represent missing data. All date fields were converted into proper date formats, and numerous hospital capacity, occupancy, and supply-related columns were converted to numeric types so they could be aggregated and analyzed reliably. Several Yes/No fields were also converted into logical values to support clearer interpretation. Finally, the fully cleaned dataset was exported as a new file for reproducibility and further analysis.

# Graphs & Tables

```{r}
#Use Cleaned Dataset
hospital <- read_csv("Data/cleaned_Hospital_Coverage.csv")
```

```{r}
hospital |>
  group_by(State) |>
  summarize(
    total_covid = sum(
      total_adult_patients_hospitalized_confirmed_covid +
      total_pediatric_patients_hospitalized_confirmed_covid,
      na.rm = TRUE
    )
  ) |>
  ggplot(aes(x = reorder(State, total_covid), y = total_covid)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Total Current COVID Hospitalizations by State",
    x = "State",
    y = "Total Hospitalized COVID Patients"
  ) +
  theme_minimal()

```

The bar chart compares the total number of hospitalized COVID-19 patients across U.S. states. A clear pattern emerges: a small group of states accounts for a disproportionately large share of COVID-19 hospitalizations. The top few states—likely those with the largest populations or ongoing outbreaks—show totals exceeding 15,000–20,000 hospitalized patients, dramatically higher than the rest of the country. After the top tier, hospitalization totals drop off steadily, forming a long downward slope, which suggests that most states have considerably lower hospitalization burdens.

```{r}
hospital %>%
  mutate(
    covid_total = total_adult_patients_hospitalized_confirmed_covid +
                  total_pediatric_patients_hospitalized_confirmed_covid
  ) %>%
  ggplot(aes(x = State, y = covid_total)) +
  geom_boxplot(fill = "skyblue") +
  coord_flip() +
  labs(
    title = "Boxplot of COVID Hospitalizations by State",
    x = "State",
    y = "COVID Hospitalizations"
  ) +
  theme_minimal()


```

Most states show relatively low and tightly clustered hospitalization counts, with medians falling between 0 and 20 patients. This suggests that for many hospitals, COVID-19 admissions were consistently low during the reporting period. However, several states exhibit much wider spreads and noticeably higher medians, indicating greater and more persistent hospitalization burdens. The states with longer boxes (larger interquartile ranges) or many high-value outliers are those experiencing more variable or elevated COVID impacts.

```{r}
hospital %>%
  group_by(State) %>%
  summarize(icu_used = sum(icu_beds_used, na.rm = TRUE)) %>%
  ggplot(aes(x = reorder(State, icu_used), y = icu_used)) +
  geom_col(fill = "firebrick") +
  coord_flip() +
  labs(
    title = "ICU Beds Used by State (Week Ending 2024-04-20)",
    x = "State",
    y = "ICU Beds Used"
  ) +
  theme_minimal()

```

The Bar graphs show the ICU beds used per state. it is directly proportional to the bar graph with the number of hospital admissions for COVID, since those will be the states with the most ICU beds used. The states with the high demand of beds could be the one's that could experience shortage of supplies due to the demand, but they could also be the ones that could have plenty of supplies due to 


```{r}
# Top 5 best-supplied states
best_states <- hospital %>%
  group_by(State) %>%
  summarize(avg_n95 = mean(n95_respirators_days_available, na.rm = TRUE)) %>%
  arrange(desc(avg_n95)) %>%
  slice(1:5)

best_states


```

```{r}
# Top 5 worst-supplied states
worst_states <- hospital %>%
  group_by(State) %>%
  summarize(avg_n95 = mean(n95_respirators_days_available, na.rm = TRUE)) %>%
  arrange(avg_n95) %>%
  slice(1:5)

worst_states

```

The two tables show which states were the best supplied in terms of having respirators versus the worst. An interesting note is that the hospitals with the most patients do not appear in the worst states. Typically busy
hospitals could experience shortage, but in this case it does not. Rather, the trend seems to be pointing towards hospitals that didn't expect an increase in demand


```{r}
hospital |>
  group_by(State) |>
  summarise(shortage_rate = mean(critical_staffing_shortage_today, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(State, shortage_rate), y = shortage_rate)) +
  geom_col(fill = "firebrick") +
  coord_flip() +
  labs(
    title = "Rate of Critical Staffing Shortages by State",
    x = "State",
    y = "Shortage Rate"
  ) +
  theme_minimal()


```

This bar chart shows how frequently hospitals in each state reported critical staffing shortages, highlighting one of the most important operational pressures on the healthcare system. The states are ordered from highest to lowest shortage rate, making it easy to identify where staffing strain is most severe.A small group of states stands out with exceptionally high shortage rates, with the top state reporting a value above 25, indicating widespread staffing challenges across its hospitals. Several other states report values between 10 and 20, suggesting persistent difficulties maintaining adequate staffing levels.

```{r}
library(tidyverse)

obtain_vars <- hospital |>
  select(
    able_to_obtain_ventilator_supplies,
    able_to_obtain_ventilator_medications,
    able_to_obtain_n95_masks,
    able_to_obtain_PAPRs,
    able_to_obtain_surgical_masks,
    able_to_obtain_eye_protection,
    able_to_obtain_single_use_gowns,
    able_to_obtain_gloves,
    able_to_obtain_launderable_gowns
  ) |>
  pivot_longer(everything(), names_to = "supply", values_to = "available")

obtain_vars |>
  group_by(supply) |>
  summarise(rate = mean(available, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(supply, rate), y = rate)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Rate of Hospitals Able to Obtain Supplies",
    x = "Supply Type",
    y = "Proportion of Hospitals"
  ) +
  theme_minimal()

```

The first chart shows the proportion of hospitals that are able to obtain key medical supplies when needed. Across nearly all supply categories—such as single-use gowns, eye protection, gloves, N95 masks, and surgical masks—the ability to obtain supplies is extremely high, with proportions near 1.0, meaning almost all hospitals report being able to acquire these items. This suggests that supply chains for standard PPE have largely stabilized.

```{r}
maintain_vars <- hospital |>
  select(
    able_to_maintain_ventilator_supplies,
    able_to_maintain_ventilator_medications,
    able_to_maintain_PAPRs,
    able_to_maintain_lab_nasal_pharyngeal_swabs,
    able_to_maintain_lab_nasal_swabs,
    able_to_maintain_lab_viral_transport_media
  ) |>
  pivot_longer(everything(), names_to = "supply", values_to = "maintainable")

maintain_vars |>
  group_by(supply) |>
  summarise(rate = mean(maintainable, na.rm = TRUE)) |>
  ggplot(aes(x = reorder(supply, rate), y = rate)) +
  geom_col(fill = "darkgreen") +
  coord_flip() +
  labs(
    title = "Rate of Hospitals Able to Maintain Supplies",
    x = "Supply Type",
    y = "Proportion of Hospitals"
  ) +
  theme_minimal()

```

The second chart evaluates whether hospitals are able to maintain adequate ongoing supplies—not just obtain them once. Here, the rates are slightly lower overall than the “able to obtain” chart, which is expected: maintaining a steady inventory requires consistent supply streams and adequate on-hand stock.

```{r}
# total covid per state
covid_quartiles <- hospital %>%
  group_by(State) %>%
  summarize(
    covid_total = sum(
      total_adult_patients_hospitalized_confirmed_covid +
        total_pediatric_patients_hospitalized_confirmed_covid,
      na.rm = TRUE
    )
  ) %>%
  mutate(covid_group = ntile(covid_total, 4))   # split into 4 groups

# add quartile info back to main data
hospital_quart <- hospital %>%
  left_join(covid_quartiles, by = "State")

# avg N95 days for each quartile
supply_quartile <- hospital_quart %>%
  group_by(covid_group) %>%
  summarize(avg_n95 = mean(n95_respirators_days_available, na.rm = TRUE))

ggplot(supply_quartile, aes(x = factor(covid_group), y = avg_n95)) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Average N95 Supply Availability by COVID Hospitalization Level",
    x = "COVID Burden Quartile (1 = Low, 4 = High)",
    y = "Average Days of N95 Supply Available"
  ) +
  theme_minimal()
```

The bar chart compares average N95 supply across the four COVID burden groups. What stands out is how little the numbers actually change from one quartile to another. Hospitals in the lowest-burden states and the highest-burden states are basically sitting at the same amount of N95 supply. That means higher COVID pressure didn’t noticeably drain N95 inventory during this week. Instead, N95 availability looks pretty steady across the board, which suggests the PPE supply chain was able to keep up with demand. This also lines up with the earlier results showing that almost all hospitals reported being able to obtain N95s when they needed them.

```{r}
ggplot(hospital, aes(x = State, y = n95_respirators_days_available)) +
  geom_boxplot(fill = "steelblue") +
  coord_flip() +
  labs(
    title = "Variation in N95 Supply Availability Across States",
    x = "State",
    y = "Days of N95 Supply Available"
  ) +
  theme_minimal()
```

This boxplot shows how much N95 supply actually varies from state to state. Even though there are a few states with lower numbers, most of them are pretty tightly grouped around 3–4 days of N95 supply. That means hospitals across the country were generally sitting at about the same level of inventory, without any states falling way behind the rest. So based on this view, N95 availability looks fairly steady overall, with only a few places showing noticeably less supply than others.